{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Alexandre Brosseau\\\\Desktop\\\\drf_react_eshop\\\\eshop\\\\src\\\\components\\\\Stripe\\\\StripeContainer.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Elements } from \"@stripe/react-stripe-js\";\nimport Payment from \"../Payment/payment\";\nimport { useSelector } from \"react-redux\";\nimport { convertLength } from \"@mui/material/styles/cssUtils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PUBLIC_KEY = 'pk_test_51Jyg7eGk75zbcxVeN4uGKWm205YsZo0R4Qn5c2rYok07G2G0PCj9wqtqGe08tcABT4v2qMHoI3OcjqruzNln7qdj00RimaDJHq';\nconst SECRET_KEY = 'sk_test_51Jyg7eGk75zbcxVe1clNVNbhNAATOVvuC0xuz6RST5pKtIPVSETBBeJHO9ReQM0t8gqfco9xJJ6LlaREWKHPGCnk00Zofrs8Un';\nconst stripeTestPromise = loadStripe(PUBLIC_KEY);\n\nconst Stripe = () => {\n  _s();\n\n  var _orderUser$;\n\n  const [clientSecret, setClientSecret] = useState(\"\");\n  const userLogin = useSelector(state => state.userLogin);\n  const {\n    userInfo\n  } = userLogin;\n  const token = userInfo.token;\n  const orderCreate = useSelector(state => state.orderCreate);\n  const {\n    orderUser\n  } = orderCreate;\n  const totalPrice = orderUser === null || orderUser === void 0 ? void 0 : (_orderUser$ = orderUser[0]) === null || _orderUser$ === void 0 ? void 0 : _orderUser$.totalPrice;\n  console.log(totalPrice);\n  useEffect(() => {\n    if (totalPrice) {\n      fetch(\"http://127.0.0.1:8000/api/stripe/create-payment-intent/\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          amount: [totalPrice]\n        })\n      }).then(res => res.json()).then(data => setClientSecret(data.clientSecret)); // eslint-disable-next-line \n    }\n  }, []);\n  const appearance = {\n    theme: 'stripe'\n  };\n  const options = {\n    clientSecret,\n    appearance\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"\",\n    children: clientSecret && /*#__PURE__*/_jsxDEV(Elements, {\n      options: options,\n      stripe: stripeTestPromise,\n      children: /*#__PURE__*/_jsxDEV(Payment, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 15\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Stripe, \"ycx+eiddnQnu/p2mdAnETMi55JI=\", false, function () {\n  return [useSelector, useSelector];\n});\n\n_c = Stripe;\nexport default Stripe;\n\nvar _c;\n\n$RefreshReg$(_c, \"Stripe\");","map":{"version":3,"names":["React","useState","useEffect","loadStripe","Elements","Payment","useSelector","convertLength","PUBLIC_KEY","SECRET_KEY","stripeTestPromise","Stripe","clientSecret","setClientSecret","userLogin","state","userInfo","token","orderCreate","orderUser","totalPrice","console","log","fetch","method","headers","Authorization","body","JSON","stringify","amount","then","res","json","data","appearance","theme","options"],"sources":["C:/Users/Alexandre Brosseau/Desktop/drf_react_eshop/eshop/src/components/Stripe/StripeContainer.js"],"sourcesContent":["import React,{useState, useEffect} from \"react\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\nimport { Elements } from \"@stripe/react-stripe-js\";\r\nimport Payment from \"../Payment/payment\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { convertLength } from \"@mui/material/styles/cssUtils\";\r\n\r\nconst PUBLIC_KEY = 'pk_test_51Jyg7eGk75zbcxVeN4uGKWm205YsZo0R4Qn5c2rYok07G2G0PCj9wqtqGe08tcABT4v2qMHoI3OcjqruzNln7qdj00RimaDJHq'\r\nconst SECRET_KEY = 'sk_test_51Jyg7eGk75zbcxVe1clNVNbhNAATOVvuC0xuz6RST5pKtIPVSETBBeJHO9ReQM0t8gqfco9xJJ6LlaREWKHPGCnk00Zofrs8Un'\r\nconst stripeTestPromise = loadStripe(PUBLIC_KEY)\r\n\r\n\r\n \r\n\r\n\r\nconst Stripe = () => {\r\n    const [clientSecret, setClientSecret] = useState(\"\");\r\n    const userLogin = useSelector(state => state.userLogin)\r\n    const {userInfo} = userLogin\r\n    const token = userInfo.token\r\n    const orderCreate = useSelector(state => state.orderCreate)\r\n    const {orderUser} = orderCreate\r\n    const totalPrice = orderUser?.[0]?.totalPrice\r\n    console.log(totalPrice)\r\n  \r\n    useEffect(() => {\r\n        \r\n       \r\n      if(totalPrice){\r\n        \r\n        fetch(\"http://127.0.0.1:8000/api/stripe/create-payment-intent/\", {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\",\r\n                     Authorization: `Bearer ${token}` },\r\n          body: JSON.stringify({ amount:  [totalPrice] }),\r\n               \r\n    })\r\n          .then((res) => res.json())\r\n          .then((data) => setClientSecret(data.clientSecret));\r\n       // eslint-disable-next-line \r\n      }}, []);\r\n    \r\n\r\n    const appearance = {\r\n        theme: 'stripe',\r\n      };\r\n\r\nconst options = {\r\n    clientSecret,\r\n    appearance,\r\n    };\r\n    return (\r\n        <div className=\"\">\r\n          {clientSecret && (\r\n            <Elements options={options} stripe={stripeTestPromise}>\r\n              <Payment />\r\n            </Elements>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\nexport default Stripe"],"mappings":";;;AAAA,OAAOA,KAAP,IAAcC,QAAd,EAAwBC,SAAxB,QAAwC,OAAxC;AACA,SAASC,UAAT,QAA2B,mBAA3B;AACA,SAASC,QAAT,QAAyB,yBAAzB;AACA,OAAOC,OAAP,MAAoB,oBAApB;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,aAAT,QAA8B,+BAA9B;;AAEA,MAAMC,UAAU,GAAG,6GAAnB;AACA,MAAMC,UAAU,GAAG,6GAAnB;AACA,MAAMC,iBAAiB,GAAGP,UAAU,CAACK,UAAD,CAApC;;AAMA,MAAMG,MAAM,GAAG,MAAM;EAAA;;EAAA;;EACjB,MAAM,CAACC,YAAD,EAAeC,eAAf,IAAkCZ,QAAQ,CAAC,EAAD,CAAhD;EACA,MAAMa,SAAS,GAAGR,WAAW,CAACS,KAAK,IAAIA,KAAK,CAACD,SAAhB,CAA7B;EACA,MAAM;IAACE;EAAD,IAAaF,SAAnB;EACA,MAAMG,KAAK,GAAGD,QAAQ,CAACC,KAAvB;EACA,MAAMC,WAAW,GAAGZ,WAAW,CAACS,KAAK,IAAIA,KAAK,CAACG,WAAhB,CAA/B;EACA,MAAM;IAACC;EAAD,IAAcD,WAApB;EACA,MAAME,UAAU,GAAGD,SAAH,aAAGA,SAAH,sCAAGA,SAAS,CAAG,CAAH,CAAZ,gDAAG,YAAgBC,UAAnC;EACAC,OAAO,CAACC,GAAR,CAAYF,UAAZ;EAEAlB,SAAS,CAAC,MAAM;IAGd,IAAGkB,UAAH,EAAc;MAEZG,KAAK,CAAC,yDAAD,EAA4D;QAC/DC,MAAM,EAAE,MADuD;QAE/DC,OAAO,EAAE;UAAE,gBAAgB,kBAAlB;UACEC,aAAa,EAAG,UAAST,KAAM;QADjC,CAFsD;QAI/DU,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;UAAEC,MAAM,EAAG,CAACV,UAAD;QAAX,CAAf;MAJyD,CAA5D,CAAL,CAOGW,IAPH,CAOSC,GAAD,IAASA,GAAG,CAACC,IAAJ,EAPjB,EAQGF,IARH,CAQSG,IAAD,IAAUrB,eAAe,CAACqB,IAAI,CAACtB,YAAN,CARjC,EAFY,CAWb;IACA;EAAC,CAfK,EAeH,EAfG,CAAT;EAkBA,MAAMuB,UAAU,GAAG;IACfC,KAAK,EAAE;EADQ,CAAnB;EAIJ,MAAMC,OAAO,GAAG;IACZzB,YADY;IAEZuB;EAFY,CAAhB;EAII,oBACI;IAAK,SAAS,EAAC,EAAf;IAAA,UACGvB,YAAY,iBACX,QAAC,QAAD;MAAU,OAAO,EAAEyB,OAAnB;MAA4B,MAAM,EAAE3B,iBAApC;MAAA,uBACE,QAAC,OAAD;QAAA;QAAA;QAAA;MAAA;IADF;MAAA;MAAA;MAAA;IAAA;EAFJ;IAAA;IAAA;IAAA;EAAA,QADJ;AASC,CA7CL;;GAAMC,M;UAEgBL,W,EAGEA,W;;;KALlBK,M;AA8CN,eAAeA,MAAf"},"metadata":{},"sourceType":"module"}